<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Shop | Sanrico Mercantile Inc.</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/stock.css">
    <link rel="stylesheet" href="css/modal.css">
    <link rel="stylesheet" href="css/forms.css">
    <link rel="stylesheet" href="css/verification-dialog.css">
    <link rel="stylesheet" href="css/tooltip.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="stylesheet" href="css/header.css">
    <link rel="stylesheet" href="css/footer.css">
    <link rel="stylesheet" href="css/shop.css">
    <link rel="stylesheet" href="css/cart-tab.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="js/simple-auth-client.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/validation.js"></script>
    <script src="js/loginButton.js"></script>
    <script src="js/login.js"></script>

    <script src="js/toast.js"></script>
    <script src="js/navigation.js"></script>
    <script src="js/headerSearch.js"></script>
    <script src="js/notifications.js"></script>
    <script src="js/addressModal.js"></script>
    <script src="js/shop.js"></script>
    <script src="js/shop-fix.js"></script>
    <script src="js/stockDisplay.js"></script>
    <script src="js/cart-tab.js"></script>
    <style>
        .search-container {
            position: relative;
            width: 500px; /* Adjust as needed */
        }

        .search-container input {
            width: 100%;
            padding: 12px 48px 12px 16px;
            border-radius: 8px;
            border: none;
            font-size: 16px;
            box-sizing: border-box;
        }

        .search-btn {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: white;
            border: none;
            padding: 0;
            cursor: pointer;
            border-radius: 50%;
            height: 36px;
            width: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
            z-index: 2;
        }

        .search-btn:hover {
            background: #f5f5f5;
        }

        /* Remove borders from header elements */
        .top-bar, .header, .main-nav,
        .top-bar *, .header *, .main-nav *,
        .container, .header-container, .nav-links,
        .logo-container, .header-search, .header-icons,
        .cart-btn, .cart-count, .nav-links a {
            border: none !important;
            outline: none !important;
            box-shadow: none !important;
        }

        /* Ensure seamless gradient */
        .top-bar, .header, .main-nav {
            margin: 0 !important;
            padding: 0 !important;
        }

        .container {
            margin: 0 auto !important;
        }

        /* Stock status ping styles */
        .in-stock-ping {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.25rem 0.75rem;
            background: rgba(0, 200, 81, 0.1);
            color: #000;
            border-radius: 1rem;
            font-size: 0.9rem;
        }

        .in-stock-ping.out-of-stock {
            background: rgba(255, 68, 68, 0.1);
            color: #000;
        }

        .ping-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #00C851;
        }

        .out-of-stock .ping-dot {
            background: #ff4444;
        }

        /* Drag and drop styles for drag handles (cart icons) */
        .drag-handle {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 16px;
            cursor: grab;
            transition: all 0.2s ease;
            z-index: 10;
            user-select: none;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }

        .drag-handle:hover {
            background: rgba(229, 57, 53, 0.9);
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(229, 57, 53, 0.4);
        }

        .drag-handle:active {
            cursor: grabbing;
            transform: scale(0.95);
        }

        .drag-handle.dragging {
            opacity: 0.7;
            transform: rotate(15deg) scale(1.2);
            transition: all 0.2s ease;
            cursor: grabbing;
        }

        /* Out of stock drag handle styles */
        .drag-handle.out-of-stock {
            background: rgba(255, 68, 68, 0.8) !important;
            color: white;
            cursor: not-allowed;
            opacity: 0.7;
        }

        .drag-handle.out-of-stock:hover {
            background: rgba(255, 68, 68, 0.9) !important;
            transform: none;
            box-shadow: 0 2px 8px rgba(255, 68, 68, 0.3);
        }

        .drag-handle.out-of-stock:active {
            cursor: not-allowed;
            transform: none;
        }

        /* Product grid layout */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.5rem;
        }

        /* Responsive grid adjustments */
        @media (max-width: 768px) {
            .product-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .product-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Product card styles - remove draggable properties */
        .product-card {
            position: relative;
            cursor: default;
            transition: all 0.2s ease;
        }

        .product-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        /* Remove old drag styles */
        .product-card::before {
            display: none;
        }

        /* Ensure product cards have relative positioning for absolute drag handle */
        .product-card {
            position: relative;
        }

        /* Drag & Drop Note styles */
        .drag-drop-note {
            z-index: 10;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
            to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }

        /* Loading animations */
        .loadingBob {
            animation: loadingBob 1.5s ease-in-out infinite;
        }

        @keyframes loadingBob {
            0%, 50%, 100% { transform: translateY(0); }
            25% { transform: translateY(-3px); }
            75% { transform: translateY(3px); }
        }

        .loading-spinner {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 400px;
            width: 100%;
            padding: 3rem;
            color: #666;
            text-align: center;
        }

        .loading-spinner .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #e63946;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-spinner p {
            margin: 0;
            font-size: 1.1rem;
            color: #666;
        }

        /* Cart wiggle animation */
        .cart-wiggle {
            animation: cartWiggle 0.6s ease-in-out;
        }

        @keyframes cartWiggle {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-3px) rotate(-2deg); }
            50% { transform: translateY(0) rotate(0deg); }
            75% { transform: translateY(-3px) rotate(2deg); }
        }

        /* Drag and drop styles - always enabled */
        .product-card {
            cursor: grab;
            position: relative;
        }

        .product-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .product-card:active {
            cursor: grabbing;
        }

        /* Product link hover effect - only blurs the link area */
        .product-link {
            display: block;
            transition: filter 0.3s ease;
        }

        .product-card:hover .product-link {
            filter: blur(2px);
        }

        /* Product details (stock and dropdowns) - always visible and clickable */
        .product-details {
            position: relative;
            z-index: 10;
            background: white;
            padding: 0.5rem;
            border-top: 1px solid #f0f0f0;
        }

        /* Product stock display */
        .product-stock {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .stock-label {
            color: #666;
            font-weight: 500;
        }

        .stock-amount {
            color: #e63946;
            font-weight: 600;
            background: rgba(230, 57, 70, 0.1);
            padding: 0.2rem 0.5rem;
            border-radius: 12px;
            font-size: 0.85rem;
        }

        /* Product filter dropdowns */
        .product-filters {
            display: flex;
            gap: 0.5rem;
        }

        .subcategory-dropdown,
        .brand-dropdown {
            flex: 1;
            padding: 0.3rem 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 0.8rem;
            background: #fff;
            color: #333;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .subcategory-dropdown:hover,
        .brand-dropdown:hover {
            border-color: #e63946;
            background: #fff;
        }

        .subcategory-dropdown:focus,
        .brand-dropdown:focus {
            outline: none;
            border-color: #e63946;
            box-shadow: 0 0 0 2px rgba(230, 57, 70, 0.2);
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .product-filters {
                flex-direction: column;
                gap: 0.3rem;
            }
            
            .subcategory-dropdown,
            .brand-dropdown {
                width: 100%;
            }
        }


        /* Loading animations */
        .loadingBob {
            animation: loadingBob 1.5s ease-in-out infinite;
        }

        @keyframes loadingBob {
            0%, 50%, 100% { transform: translateY(0); }
            25% { transform: translateY(-3px); }
            75% { transform: translateY(3px); }
        }

        .loading-spinner {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 400px;
            width: 100%;
            padding: 3rem;
            color: #666;
            text-align: center;
        }

        .loading-spinner .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #e63946;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-spinner p {
            margin: 0;
            font-size: 1.1rem;
            color: #666;
        }
    </style>
</head>
<body>
    <!-- Top Bar -->
    <div class="top-bar">
        <div class="container">
            <div class="social-links">
                <span><marquee>Let's build something great together!</marquee></span>
            </div>
            <div class="user-links">
                <div class="notification-container">
                    <button class="notification-btn" id="notificationBtn">
                        <span class="notification-label">Notifications</span>
                        <i class="fa fa-bell notification-icon"></i>
                        <span class="notification-badge" id="notificationBadge">0</span>
                    </button>
                    <div class="notification-dropdown" id="notificationDropdown">
                    <div class="notification-header">
                        <h3>Notifications</h3>
                            <button class="clear-all-btn" id="clearAllBtn">Clear All</button>
                    </div>
                        <div class="notification-list" id="notificationList">
                            <!-- Notifications will be populated here -->
                        </div>
                    </div>
                </div>
                <a href="#" id="topLoginBtn">Login</a>
                <div id="userDropdown" class="user-dropdown" style="display:none;">
                    <a href="profile.html" class="dropdown-item">My Account</a>
                    <a href="order-history.html" class="dropdown-item">Order History</a>
                    <!-- <a href="#" class="dropdown-item">My Wish List</a> -->
                    <a href="addresses.html" class="dropdown-item">My Addresses</a>
                    <a href="#" id="logoutBtn" class="dropdown-item">Log Out</a>
                </div>
            </div>
        </div>
    </div>
    <!-- Header -->
    <header>
        <div class="container header-container">
            <div class="logo-container">
                <a href="index.html" class="logo-link">
                    <div class="logo-wrapper" data-tooltip="Take me home">
                    <img src="images/sanrico_logo_1.png" alt="Sanrico Mercantile Logo" class="logo-img">
                    </div>
                    <span class="logo">
                        <span>Sanrico</span> <span>Mercantile</span>
                    </span>
                </a>
            </div>
            <form class="header-search">
                <input type="text" placeholder="Search for products..." />
                <button type="submit">
                    <svg width="20" height="20" fill="none" stroke="#e53935" stroke-width="2" viewBox="0 0 24 24">
                        <circle cx="11" cy="11" r="8"/>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"/>
                    </svg>
                </button>
            </form>
            <div class="header-icons"></div>
        </div>
    </header>

    <!-- Navigation Menu -->
    <nav class="main-nav">
        <div class="container">
            <div class="nav-links">
                <a href="index.html">Home</a>
                <a href="shop.html" class="active">Shop</a>
                <a href="aboutus.html">About Us</a>

                <!-- Information Dropdown Menu -->
                <div class="nav-dropdown">
                    <button class="nav-dropdown-toggle" id="policiesDropdown">
                        Information
                        <i class="fa fa-chevron-down dropdown-arrow"></i>
                    </button>
                    <div class="nav-dropdown-menu" id="policiesDropdownMenu">
                        <a href="terms.html" class="dropdown-item">Terms and Conditions</a>
                        <a href="privacy.html" class="dropdown-item">Privacy Policy</a>
                        <a href="security.html" class="dropdown-item">Online Security & Safety</a>
                        <a href="faq.html" class="dropdown-item">FAQs</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Shop Section -->
    <section class="shop-section">
        <div class="container" style="display: flex; gap: 2.5rem; align-items: flex-start;">
            <!-- Sidebar -->
            <aside style="min-width: 220px; max-width: 260px;">
                <a href="#" onclick="window.history.back(); return false;" style="color: #222; font-size: 1rem; text-decoration: none; display: inline-block; margin-bottom: 1.2rem;">&lt; Back</a>
                <h2 style="font-size: 2rem; font-weight: 700; margin-bottom: 0.5rem; color: #222;">Products <span style="font-size: 1.1rem; color: #888; font-weight: 400;">(<span id="productCount">0</span> available)</span></h2>
                <p style="font-size: 1rem; color: #666; margin-bottom: 1rem;">Sort By</p>
                <div style="margin-bottom: 2rem;">
                    <h3 style="font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; color: #222;">Price Range</h3>
                    <div style="display: flex; gap: 0.5rem; align-items: center; margin-bottom: 1rem;">
                        <div style="position: relative;">
                            <span style="position: absolute; left: 8px; top: 50%; transform: translateY(-50%); color: #666;">â‚±</span>
                            <input type="number" id="minPrice" placeholder="Min" style="width: 100px; padding: 8px 8px 8px 20px; border: 1px solid #ddd; border-radius: 4px;">
                        </div>
                        <span style="color: #666;">to</span>
                        <div style="position: relative;">
                            <span style="position: absolute; left: 8px; top: 50%; transform: translateY(-50%); color: #666;">â‚±</span>
                            <input type="number" id="maxPrice" placeholder="Max" style="width: 100px; padding: 8px 8px 8px 20px; border: 1px solid #ddd; border-radius: 4px;">
                        </div>
                    </div>
                    <button id="applyPriceRange" style="background: #e63946; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; width: 100%;">Apply</button>
                </div>
                <div style="margin-bottom: 2rem;">
                    <h3 style="font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; color: #222;">Category</h3>
                    <ul id="categorySidebar" style="list-style: none; padding: 0; margin: 0;">
                        <li><a href="#" class="category-link" data-category="all">All</a></li>
                        <li><a href="#" class="category-link" data-category="paints">Paints and Painting Supplies</a></li>
                        <li><a href="#" class="category-link" data-category="tools-accessories">Tools and Accessories</a></li>
                        <li><a href="#" class="category-link" data-category="building-materials-aggregates">Building Materials and Aggregates</a></li>
                        <li><a href="#" class="category-link" data-category="electrical-supplies">Electrical Supplies</a></li>
                        <li><a href="#" class="category-link" data-category="plumbing-fixtures">Plumbing and Fixtures</a></li>
                        <li><a href="#" class="category-link" data-category="fasteners-consumables">Fasteners and Consumables</a></li>
                        <li><a href="#" class="category-link" data-category="other">Other</a></li>
                    </ul>
                </div>
            </aside>
            
            <!-- Main Content -->
            <div class="main-content" style="flex: 1;">
                <div class="shop-controls" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; position: relative;">
                    <div id="searchResults" style="display: none;">
                        <span style="color: #666;">Search results for: </span>
                        <span id="searchKeyword" style="font-weight: 600; color: #2a6592;"></span>
                        <a href="shop.html" style="margin-left: 1rem; color: #e63946; text-decoration: none; font-size: 0.9rem;">
                            <i class="fa fa-times"></i> Clear
                        </a>
                    </div>
                    <button id="clearFiltersBtn" style="position: absolute; left: 0; top: 50%; transform: translateY(-50%); background: none; border: none; color: #e63946; cursor: pointer; font-size: 0.9rem; display: flex; align-items: center; gap: 0.5rem;">
                        <i class="fa fa-times"></i> Clear Filters
                    </button>

                    <!-- Drag & Drop Note -->
                    <div class="drag-drop-note" style="position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); display: flex; align-items: center; gap: 0.5rem; background: rgba(230, 57, 70, 0.1); padding: 0.5rem 1rem; border-radius: 20px; border: 1px solid rgba(230, 57, 70, 0.2);">
                        <i class="fa fa-hand-grab-o" style="color: #e63946; font-size: 0.9rem;"></i>
                        <span style="font-size: 0.85rem; color: #e63946; font-weight: 500;">Drag the ðŸ›’ of an item into the cart for easier shopping</span>
                        </div>


                    <div class="sort-group" style="position: absolute; right: 0; top: 50%; transform: translateY(-50%); display: flex; align-items: center; gap: 0.5rem;">
                        <span style="font-size: 0.9rem; color: #666;">Sort by</span>
                        <select id="sort-by" style="padding: 4px 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 0.9rem; width: 120px;">
                            <option value="all">All Products</option>
                            <option value="price-low">Price: Low to High</option>
                            <option value="price-high">Price: High to Low</option>
                            <option value="name">Name: A-Z</option>
                        </select>
                    </div>
                </div>
                <div class="product-grid" id="product-grid">
                    <!-- Products will be populated by JavaScript -->
                </div>
                <div class="pagination" id="pagination">
                    <!-- Pagination controls will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </section>

    <!-- Sliding Cart Tab -->
    <div class="cart-tab" id="cartTab">
        <div class="cart-tab-content" id="cartTabContent">
            <div class="cart-tab-header">
                <h3>Your Cart</h3>
                <button class="close-cart" id="closeCart">
                    <i class="fa fa-times"></i>
                </button>
            </div>
            <div class="cart-items" id="cartItems">
                <div class="cart-empty">
                    <img src="images/cart-empty.png" alt="Empty Cart">
                    <p>Your cart is empty</p>
                </div>
            </div>
            <div class="cart-total" id="cartTotal">
                <div class="subtotal">
                    <span>Subtotal:</span>
                    <span id="cartSubtotal">â‚±0.00</span>
                </div>
                <div class="cart-actions">
                    <button class="clear-cart-btn" id="clearCartBtn">Clear Cart</button>
                    <button class="go-to-cart-btn" id="goToCartBtn">Go to Cart</button>
                </div>
            </div>
        </div>
        <button class="cart-tab-button" id="cartTabButton">
            <i class="fa fa-shopping-cart"></i>
            <span class="cart-count" id="cartCount">0</span>
        </button>
    </div>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <button class="modal-close" id="modalClose">Ã—</button>
            <h2 class="modal-title">Welcome Back</h2>
            
            <!-- Login Mode Tabs -->
            <div class="tab-buttons" id="loginTabs">
                <button class="tab-btn active" data-tab="user-login">User Login</button>
                <button class="tab-btn" data-tab="staff-login">Staff Login</button>
            </div>
            
            <div class="tab-container">
                
                <!-- User Login Tab -->
                <div class="tab-content active" id="user-login">
                    <div class="form-group">
                        <label for="user-email">Email Address</label>
                        <input type="email" id="user-email" class="form-control" placeholder="Enter your email address">
                    </div>
                    <div class="form-group">
                        <label for="user-password">Password</label>
                        <input type="password" id="user-password" class="form-control" placeholder="Enter your password">
                    </div>
                    <button class="btn" id="userLoginSubmitBtn">Sign In</button>
                    
                    <div class="signup-prompt" style="text-align: center; margin: 16px 0;">
                        <span style="color: #7f8c8d; font-size: 14px;">Don't have an account? </span>
                        <button type="button" class="signup-link" onclick="showRegistrationModal()" style="background: none; border: none; color: #3498db; font-size: 14px; font-weight: 600; cursor: pointer; padding: 0; text-decoration: underline;">Create one today</button>
                    </div>
                    
                    <div class="login-separator">
                        <div></div>
                        <span>or continue with</span>
                        <div></div>
                    </div>
                    
                    <div class="google-signin-container">
                        <div id="g_id_onload"
                             data-client_id="856316440062-00drlhn0s99moqu4a0ktbvgrk0l4mda2.apps.googleusercontent.com"
                             data-callback="handleGoogleSignIn"
                             data-auto_prompt="false">
                        </div>
                        <div class="g_id_signin" 
                             data-type="standard" 
                             data-size="large" 
                             data-theme="outline" 
                             data-text="sign_in_with" 
                             data-shape="rectangular" 
                             data-logo_alignment="left"
                             title="Sign in/Sign up using a Google account">
                        </div>
                    </div>
                    
                    <div class="forgot-password-prompt" style="text-align: center; margin: 16px 0 0 0;">
                        <span style="color: #7f8c8d; font-size: 14px;">Forgot your password? </span>
                        <button type="button" class="forgot-password-link" onclick="showRegistrationModal('forgot-password')" style="background: none; border: none; color: #3498db; font-size: 14px; font-weight: 600; cursor: pointer; padding: 0; text-decoration: underline;">Retrieve it today</button>
                    </div>
                </div>

                <!-- Staff Login Tab -->
                <div class="tab-content" id="staff-login">
                    <div class="form-group">
                        <label for="staff-id">Staff Username</label>
                        <input type="text" id="staff-id" class="form-control" placeholder="Enter your staff username">
                    </div>
                    <div class="form-group">
                        <label for="staff-password">Password</label>
                        <input type="password" id="staff-password" class="form-control" placeholder="Enter your password">
                    </div>
                    <button class="btn" id="staffLoginSubmitBtn">Staff Sign In</button>
                    
                    <div class="staff-login-note" style="text-align: center; margin-top: 16px; color: #7f8c8d; font-size: 14px;">
                        Staff credentials only. No social login available.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Registration Modal -->
    <div class="modal" id="registrationModal">
        <div class="modal-content">
            <button class="modal-close" id="registrationModalClose">Ã—</button>
            <h2 class="modal-title">Create Account</h2>
            
            <!-- Registration Mode Tabs -->
            <div class="tab-buttons" id="registrationTabs">
                <button class="tab-btn active" data-tab="user-signup">Register</button>
                <button class="tab-btn" data-tab="forgot-password">Account Recovery</button>
            </div>
            
            <div class="tab-container">
                
                <!-- User Signup Tab -->
                <div class="tab-content active" id="user-signup">
                    <div class="form-group">
                        <label for="signup-fullname">Full Name</label>
                        <input type="text" id="signup-fullname" class="form-control" placeholder="Enter your full name">
                        <div class="error-message"></div>
                        <div class="success-message"></div>
                    </div>
                    <div class="form-group">
                        <label for="signup-email">Email Address</label>
                        <input type="email" id="signup-email" class="form-control" placeholder="Enter your email address">
                        <div class="error-message"></div>
                        <div class="success-message"></div>
                    </div>
                    <div class="form-group">
                        <label for="signup-password">Password</label>
                        <input type="password" id="signup-password" class="form-control" placeholder="Create a strong password">
                        <div class="password-strength">
                            <div class="strength-bar">
                                <div class="strength-fill"></div>
                            </div>
                            <div class="strength-text"></div>
                        </div>
                        <div class="error-message"></div>
                        <div class="success-message"></div>
                    </div>
                    <div class="form-group">
                        <label for="signup-confirm-password">Confirm Password</label>
                        <input type="password" id="signup-confirm-password" class="form-control" placeholder="Confirm your password">
                        <div class="error-message"></div>
                        <div class="success-message"></div>
                    </div>
                    <button class="btn" id="userSignupSubmitBtn">Create My Account</button>
                    
                    <div class="signup-prompt" style="text-align: center; margin: 16px 0;">
                        <span style="color: #7f8c8d; font-size: 14px;">Already have an account? </span>
                        <button type="button" class="login-link" onclick="showLoginModal()" style="background: none; border: none; color: #3498db; font-size: 14px; font-weight: 600; cursor: pointer; padding: 0; text-decoration: underline;">Sign in here</button>
                    </div>
                    
                    <div class="login-separator">
                        <div></div>
                        <span>or continue with</span>
                        <div></div>
                    </div>
                    
                    <div class="google-signin-container">
                        <div id="g_id_onload"
                             data-client_id="856316440062-00drlhn0s99moqu4a0ktbvgrk0l4mda2.apps.googleusercontent.com"
                             data-callback="handleGoogleSignIn"
                             data-auto_prompt="false">
                        </div>
                        <div class="g_id_signin" 
                             data-type="standard" 
                             data-size="large" 
                             data-theme="outline" 
                             data-text="sign_up_with" 
                             data-shape="rectangular" 
                             data-logo_alignment="left"
                             title="Sign up using a Google account">
                        </div>
                    </div>
                    </div>

                <!-- Forgot Password Tab -->
                <div class="tab-content" id="forgot-password">
                    <div class="form-group">
                        <label for="forgot-email">Email Address</label>
                        <input type="email" id="forgot-email" class="form-control" placeholder="Enter your email address">
                        <div class="error-message"></div>
                        <div class="success-message"></div>
                    </div>
                    <button class="btn" id="forgotPasswordSubmitBtn">Send Recovery Email</button>
                    
                    <div class="signup-prompt" style="text-align: center; margin: 16px 0;">
                        <span style="color: #7f8c8d; font-size: 14px;">Remember your password? </span>
                        <button type="button" class="login-link" onclick="showLoginModal()" style="background: none; border: none; color: #3498db; font-size: 14px; font-weight: 600; cursor: pointer; padding: 0; text-decoration: underline;">Sign in here</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-container">
                <div class="footer-col">
                    <h4>Shop</h4>
                    <ul>
                        <li><a href="shop.html?category=power-tools">Power Tools</a></li>
                        <li><a href="shop.html?category=hand-tools">Hand Tools</a></li>
                        <li><a href="shop.html?category=plumbing">Plumbing</a></li>
                        <li><a href="shop.html?category=electrical">Electrical</a></li>
                        <li><a href="shop.html?category=building-materials">Building Materials</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Information</h4>
                    <ul>
                        <li><a href="aboutus.html">About Us</a></li>
                        <li><a href="faq.html">FAQ</a></li>
                        <li><a href="terms.html">Terms and Conditions</a></li>
                        <li><a href="privacy.html">Privacy Policy</a></li>
                        <li><a href="security.html">Online Security & Safety</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="order-history.html">Order History</a></li>
                        <li><a href="addresses.html">My Addresses</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Contact Us</h4>
                    <ul>
                        <li>Regalado Avenue</li>
                        <li>Fairview, Quezon City</li>
                        <li>Phone: (555) 123-4567</li>
                        <li>Email: <a href="mailto:support@sanricomercantile@gmail.com">support@sanricomercantile@gmail.com</a></li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                Â© 2025 Sanrico Mercantile Inc. All Rights Reserved.
            </div>
        </div>
    </footer>

    <!-- Toast Container -->
    <div class="toast" id="toast"></div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <div class="loading-text">
                Authenticating<span class="loading-dots">...</span>
            </div>
        </div>
    </div>

    <!-- Scroll to Top Button -->
    <button class="scroll-to-top" id="scrollToTop">
        <i class="fa fa-arrow-up"></i>
    </button>


    <script>
        // Loading animation functions
        function showLoadingProducts() {
            const productGrid = document.getElementById('product-grid');
            productGrid.innerHTML = `
                <div class="loading-spinner" style="grid-column: 1 / -1; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 60vh; width: 100%; text-align: center;">
                    <div class="spinner"></div>
                    <p>Loading products...</p>
                </div>
            `;
        }

        function showLoadingProductCount() {
            const productCount = document.getElementById('productCount');
            productCount.innerHTML = '<span class="loadingBob">...</span>';
        }

        // Check if logged in as staff and redirect if needed
        if (Auth.redirectIfStaff()) {
            // Stop further execution if redirecting
            throw new Error('Redirecting to staff dashboard');
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            try {
                // Update cart count
                Auth.updateCartCount();
                
                // Update login/signup buttons based on auth state
                const currentUser = Auth.getCurrentUser();
                if (currentUser) {
                    // User is logged in
                    const topLoginBtn = document.getElementById('topLoginBtn');
                    if (topLoginBtn) {
                        topLoginBtn.textContent = currentUser.fullName || 'My Account';
                        topLoginBtn.href = currentUser.isStaff ? 'staff-dashboard.html' : 'profile.html';
                        topLoginBtn.removeEventListener('click', showLoginModal);
                    }
                }
                
                // Show loading animations
                showLoadingProducts();
                showLoadingProductCount();
                
                // Load products
                loadProducts();
            } catch (error) {
                console.error('Error during initialization:', error);
            }
        });

        // Modal functions are now handled by js/login.js centrally

        // Function to show forgot password modal
        function showForgotPasswordModal() {
            showRegistrationModal('forgot-password');
        }

        // Top bar login/signup handlers are now handled by login.js

        // Cart button redirect
        document.getElementById('cartBtn').addEventListener('click', (e) => {
            e.preventDefault();
            if (!Auth.isLoggedIn()) {
                showToast('Please log in to view your cart.');
                document.getElementById('loginModal').classList.add('show');
            } else {
                window.location.href = 'cart.html';
            }
        });

        // Scroll to Top functionality
        const scrollToTopBtn = document.getElementById('scrollToTop');
        
        window.addEventListener('scroll', () => {
            if (window.pageYOffset > 300) {
                scrollToTopBtn.classList.add('visible');
            } else {
                scrollToTopBtn.classList.remove('visible');
            }
        });

        scrollToTopBtn.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // Add Google Sign-In handler function
        function handleGoogleSignIn(response) {
            const idToken = response.credential;
            if (!idToken) {
                console.error('No idToken received');
                showToast('Google Sign-In failed: No token received');
                return;
            }
            // Try login first
            let result = Auth.googleLogin(idToken);
            console.log('Login Result:', result);
            if (!result.success && result.message.includes("not registered")) {
                // If login fails due to user not existing, attempt registration
                result = Auth.googleRegister(idToken);
                console.log('Registration Result:', result);
            }
            showToast(result.message);
            if (result.success) {
                document.getElementById('loginModal').classList.remove('show');
                window.location.reload(); // Reload to update header
            }
        }

        // Policies Dropdown Functionality
        const policiesDropdown = document.getElementById('policiesDropdown');
        const policiesDropdownMenu = document.getElementById('policiesDropdownMenu');

        if (policiesDropdown && policiesDropdownMenu) {
            // Toggle dropdown on click
            policiesDropdown.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();

                // Close other open dropdowns first
                document.querySelectorAll('.nav-dropdown-toggle').forEach(toggle => {
                    if (toggle !== policiesDropdown) {
                        toggle.classList.remove('active');
                    }
                });

                // Toggle current dropdown
                const isActive = policiesDropdown.classList.contains('active');
                policiesDropdown.classList.toggle('active');

                // Close dropdown if it was already active
                if (isActive) {
                    policiesDropdown.classList.remove('active');
                }
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', function(e) {
                if (!policiesDropdown.contains(e.target) && !policiesDropdownMenu.contains(e.target)) {
                    policiesDropdown.classList.remove('active');
                }
            });

            // Close dropdown on escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && policiesDropdown.classList.contains('active')) {
                    policiesDropdown.classList.remove('active');
                }
            });

            // Handle dropdown item clicks
            const dropdownItems = policiesDropdownMenu.querySelectorAll('.dropdown-item');
            dropdownItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    // Close dropdown after item selection
                    policiesDropdown.classList.remove('active');
                });
            });

            // Mobile touch support
            if ('ontouchstart' in window) {
                policiesDropdown.addEventListener('touchstart', function(e) {
                    e.preventDefault();
                });
            }
        }

        // Add loading animations for filter controls
        document.addEventListener('DOMContentLoaded', () => {
            // Price range filter
            const applyPriceBtn = document.getElementById('applyPriceRange');
            if (applyPriceBtn) {
                applyPriceBtn.addEventListener('click', () => {
                    showLoadingProducts();
                    setTimeout(() => {
                        // Let the existing filter logic handle the actual filtering
                    }, 200);
                });
            }

            // Sort dropdown
            const sortSelect = document.getElementById('sort-by');
            if (sortSelect) {
                sortSelect.addEventListener('change', () => {
                    showLoadingProducts();
                    setTimeout(() => {
                        // Let the existing filter logic handle the actual filtering
                    }, 150);
                });
            }

            // Category filters
            const categoryLinks = document.querySelectorAll('.category-link');
            categoryLinks.forEach(link => {
                link.addEventListener('click', () => {
                    showLoadingProducts();
                    setTimeout(() => {
                        // Let the existing filter logic handle the actual filtering
                    }, 150);
                });
            });
        });
    </script>

    <!-- Reference: Product Images for Shop (ensure these files exist in images/item_images_filler/) -->
    <!--
    <img src="images/item_images_filler/1.jpg" alt="Product 1" style="width:100px;">
    <img src="images/item_images_filler/2.jpg" alt="Product 2" style="width:100px;">
    <img src="images/item_images_filler/3.jpg" alt="Product 3" style="width:100px;">
    <img src="images/item_images_filler/4.jpg" alt="Product 4" style="width:100px;">
    <img src="images/item_images_filler/5.jpg" alt="Product 5" style="width:100px;">
    -->
</body>
</html>
